var domain="tvmao.com";$(function(){if($.browser.msie&&$.browser.version<7){try{document.execCommand("BackgroundImageCache",false,true)}catch(a){}}});(function(a){a.fn.autoCenter=function(){return this.each(function(){a(this).css("position","absolute");var c=(a(window).height()-a(this).outerHeight())/2;var b=(a(window).width()-a(this).outerWidth())/2;if(b<0){b=0}if(c<0){c=0}a(this).css({left:a(document).scrollLeft()+b,top:a(document).scrollTop()+c})})}})(jQuery);$.extend({encode:function(a){return encodeURIComponent(a)}});$(function(){gUser=function(){var b=$("meta[id='umeta']");var c=["新浪微博","腾讯微博","QQ空间"];var a=new Object();a.$umeta=b;a.id=b.length?parseInt(b.attr("uid")):0;a.sns=b.length?b.attr("sns"):"";a.r=b.length?b.attr("r"):"0";a.getSnsCheckboxInfo=function(){if(a.id<1||a.sns==""){return'<span class="synccfg">想将评论同步到微博? 请您先<a href="/setting/snssync">简单配置一下同步</a></span>'}else{var g=a.sns.split(",");var e=b.attr("status").split(",");var d="";for(var f=0;f<g.length;f++){d+='<input type="checkbox" name="snssource" value="'+g[f]+'"';if(e[f]==1){d+=" checked"}d+=">"+c[g[f]-1]}return'<span class="synccfg">同步发送到</span>'+d+'<a href="/setting/snssync" class="synccfg">增加/修改同步配置</a>'}};a.getCheckedSnsSourceSite=function(e){var d="";e.find("input[name='snssource'][checked]").each(function(f){d=d+$(this).val()+"|"});return d};a.logged=function(){return a.id>0};return a}();gObject=function(){var a=$("meta[id='ometa']");var b=new Object();b.ometa=a;b.id=a.length?parseInt(a.attr("name")):0;b.idE=a.length?a.attr("content"):"";return b}()});function increaseNum(a){if(!a){return}var b=parseInt(a.text().replace(new RegExp("[^0-9]+"),""))+1;a.text(a.text().replace(/\d+/,b))}function isEmpty(a){return(len(a)<1)}function len(b){var a=b.replace(/^\s*|\s*$/g,"");return a.replace(/[^\x00-\xff]/g,"**").length}function getSiteBaseUrl(){var a=window.location;var b=a.protocol+"//"+a.host;if(a.port){b+=":"+port}return b}function isEmail(b){var a=new RegExp(/^[a-z0-9]+([-\\._]?[a-z0-9]+)*@([a-z0-9]*[-_]?[a-z0-9]+)+[\\.][a-z]{2,4}([\\.][a-z]{2,3})?$/i);return a.exec(b)}function RW(a){if(a==undefined){window.location.reload(true)}else{window.location.href=a;if(a.indexOf("#")>0){window.location.reload(true)}}}var imgReady=(function(){var d=[],c=null,b=function(){var e=0;for(;e<d.length;e++){d[e].end?d.splice(e--,1):d[e]()}!d.length&&a()},a=function(){clearInterval(c);c=null};return function(f,k,m,j){var l,g,n,i,e,h=new Image();h.src=f;if(h.complete){k.call(h);m&&m.call(h);return}g=h.width;n=h.height;h.onerror=function(){j&&j.call(h);l.end=true;h=h.onload=h.onerror=null};l=function(){i=h.width;e=h.height;if(i!==g||e!==n||i*e>1024){k.call(h);l.end=true}};l();h.onload=function(){!l.end&&l();m&&m.call(h);h=h.onload=h.onerror=null};if(!l.end){d.push(l);if(c===null){c=setInterval(b,40)}}}})();jwindow.DEFAULT_OPTS={width:600,minWidth:"auto",maxHeight:"auto",scrollY:"auto",modal:true,title:"",titlecss:"title_w",bg:"bg"};function jwindow(b,a){if(typeof(a)!="object"){a={}}$.extend(this,jwindow.DEFAULT_OPTS,a);this.eId=b;this.winWrap=$("#"+this.eId);if(this.winWrap){this.winWrap.remove()}this.winWrap=$('<div id="'+this.eId+'" class="win_w"></div>');this.winWrap.css({width:this.width});this.bg=$('<div class="'+this.bg+'"></div>');this.titlebar=$('<div class="'+this.titlecss+' clear"></div>');this.closeBtn=$('<a class="close_icon rt" href="javascript:void(0);" title="关闭"></a>');this.closeBtn.click(this.bindToObj(function(){if(this.eId=="ulogin"){pushTJ("登录","关闭","","","")}this.close()}));this.titleWrap=$('<div class="title lt"></div>');this.titlebar.append(this.titleWrap,this.closeBtn);this.setTitle(this.title);this.content=$('<div class="content mg3"></div>');if($.browser.msie&&$.browser.version<=8){}else{this.content.css({"min-width":this.minWidth,"max-height":this.maxHeight,"overflow-y":this.scrollY})}this.bg.append(this.titlebar,this.content);this.winWrap.append(this.bg);this.buttonWrap=$('<div class="alignct btn_w mt20"></div>')}jwindow.prototype={setTitle:function(a){this.titleWrap.html(a)},appendContent:function(a){this.content.append(a)},clearContent:function(a){this.content.empty()},hideMask:function(){if(this.modal){var a=false;$(".win_w").each(function(){if($(this).is(":visible")){a=true;return}});if(!a){$("#win_mask").fadeOut("normal").remove()}}},show:function(){this.winWrap.appendTo("body");if(this.modal){if($("#win_mask").length==0){$('<div id="win_mask"></div>').appendTo("body");$("#win_mask").hide()}}this.winWrap.fadeIn("fast");if(this.modal){$("#win_mask").fadeIn("normal")}this.setPosition()},close:function(){this.winWrap.fadeOut("fast");this.winWrap.remove();this.hideMask()},addOkButton:function(a){this.okButton=$('<input type="button" class="button white_btn" value="'+a+'"/>');this.buttonWrap.append(this.okButton);if($(".btn_w",this.content).length==0){this.content.append(this.buttonWrap)}return this.okButton},addCancelButton:function(a){if(a==undefined){a="取消"}this.cancelButton=$('<a href="#" class="ml10">'+a+"</a>");this.cancelButton.click(this.bindToObj(function(){this.close();return false}));this.buttonWrap.append(this.cancelButton);if($(".btn_w",this.content).length==0){this.content.append(this.buttonWrap)}return this.cancelButton},setPosition:function(){this.winWrap.autoCenter()},bindToObj:function(b){var a=this;return function(){return b.apply(a,arguments)}}};var TipsDialog=function(a){this.el=$(a);jwindow.call(this,"tips_w",{width:"auto",minWidth:100});this.modal=false};TipsDialog.prototype=new jwindow();TipsDialog.prototype.setPosition=function(){setPosition(this.el,this.winWrap)};$.extend({alert:function(b){var a=new jwindow("alert_w",{width:300});a.appendContent('<div class="alert_icon"></div>');a.appendContent($('<div class="alert_msg"></div>').append(b));a.addOkButton("确定").click(function(){a.close()});a.show()},toast:function(e,d){var a=$('<div class="msg"></div>');a.appendTo("body");a.css({"z-index":1000,padding:10,background:"#1e98df"});a.append($('<span class="white"></span>').append(e)).autoCenter();var b=3;if(d!=undefined){try{b=parseInt(d)}catch(c){}}a.fadeOut(b*1000);setTimeout(function(){a.remove()},b*1050)},confirm:function(c,b){var a=new jwindow("confirm",{width:"250px",height:"100px",modal:true});a.appendContent(c);a.addOkButton("确定").click(function(){a.close();b()});a.addCancelButton("取消");a.show()}});LoadingDialog=function(){var a=function(){this.dialog=$('<div id="loadingWrap"><div class="loading lt"></div><div class="msg lt"></div></div>')};a.prototype.show=function(b){$("body").append(this.dialog);this.dialog.fadeIn("fast").autoCenter();if(b){$(".msg",this.dialog).empty().append(b)}};a.prototype.hide=function(){this.dialog.fadeOut("fast");this.dialog.remove()};return new a()}();function openLogin(callback,action,isRegister){var login="cur_op";var loginCss="";var register="";var registerCss="none";if(isRegister){register="cur_op";registerCss="";login="";loginCss="none"}var win='<div style="width:380px;margin:0 auto">';win+='<dl class="clear mt50">';win+='<dd class="lt alignct '+login+'" style="width:80px">';win+='<a class="op_login black_link font22" href="javascript:;" style="font-weight:bold">登录</a>';win+="</dd>";win+='<dd class="lt alignct ml20 '+register+'" style="width:80px">';win+='<a class="op_register black_link font22" href="javascript:;" style="font-weight:bold">注册</a>';win+="</dd></dl>";win+='<ul class="user_login mt25 '+loginCss+'">';win+='<li class="mb10"><span>账号登录：</span><span class="error_msg"></span></li>';win+='<li class="mb20"><input id="lemail" name="email" class="textbox gray_textbox" size="20" maxlength="32" type="text" placeholder="邮箱/手机号" ></li>';win+='<li class="mb20">';win+='<input id="lpwd" name="pwd" size="20" maxlength="32" class="textbox gray_textbox" type="password" placeholder="密码"></li>';win+='<li class="mb20">';win+='<input id="autoLogin" tabindex="4" type="checkbox" checked>';win+="<span>下次自动登录</span>";win+='<a class="font12 rt mr10" id="forgetpwd" href="/accounts/lostpwd">忘记密码</a></li>';win+='<li><input type="button" name="login" value="　　登录　　" class="tm-bt-button"></li>';win+="</ul>";win+='<div class="u_reg '+registerCss+'">';win+='<div class="mt25" id="zc_0"><span>账号注册：</span>';win+='<span style="color:red" id="reg_err_str"></span><ul class="user_register mt10">';win+='<li><input tabindex="1" id="userphone" name="userphone" class="textbox gray_textbox" maxlength="11" type="text" value="" placeholder="请输入手机号"><span id="phone_err" class="hint">请输入正确的手机号</span></li>';win+='<li><input tabindex="2" id="username" name="username" class="textbox gray_textbox" maxlength="20" type="text" value="" placeholder="请输入昵称"><span id="username_err" class="hint">2-20个字符(中英文、数字和下划线)</span></li>';win+='<li><div id="drag"></div></li>';win+='<li><input tabindex="4" name="agreement" id="agreement" value="y" type="checkbox" checked="" onclick="return false;" ><label for="agreement">我已经认真阅读并同意电视猫的《<a href="/accounts/agreement" target="_blank">使用协议</a>》。</label><span id="ag_err" class="hint">请认真阅读并同意《使用协议》后方可注册。</span></li>';win+='<li><div class="register_btn"></div></li>';win+="</ul></div>";win+='<div id="zc_1" class="none"><p>我们已经发送一条验证短信至<span class="reg_phone">+86 [PHONE]</span></p><p>请输入短信中的验证码</p>';win+='<div class="clear" style="margin-bottom:30px;margin-top:20px;"><input type="text" placeholder="请输入验证码" class="gray_textbox textbox" id="phone_code" name="phone_code" style="float:left;width:240px"/> <span class="again again_gray">重新发送<span class="time"></span></span></div>';win+='<a href="javascript:;" class="to_next clear" c_i="1">下一步</a><a href="javascript:;" class="to_prev clear" c_i="1">返回</a></div>';win+='<div id="zc_2" class="none"><p>设置密码</p>';win+='<div style="margin-bottom:10px;"><input tabindex="3" id="pwd" name="pwd" class="textbox gray_textbox" type="password" placeholder="密码"><span id="pwd_err" class="hint" style="display: none;">6-12个英文字母、符号和数字。</span></div>';win+='<div style="margin-bottom:10px;"><input tabindex="3" id="pwd2" name="pwd2" class="textbox gray_textbox" type="password" placeholder="重复密码"><span id="pwd2_err" class="hint" style="display: none;">6-12个英文字母、符号和数字。</span></div>';win+='<div><a class="post_pwd regp_btn" href="javascript:;">确定</a></div>';win+="</div></div>";dialog=new jwindow("ulogin",{width:480,titlecss:"pr10 pt10",bg:"login_bg"});dialog.appendContent(win);dialog.show();$("#drag").drag();if(action){pushTJ("登录","窗口",action,"","")}var backurl=window.location.href;if(callback&&"function"!=typeof callback){var index=backurl.indexOf(callback);if(index<=0){backurl=backurl+callback}}$(".thirdx a").each(function(){var url=$(this).attr("href");url+=url.indexOf("?")>0?"&":"?";$(this).attr("href",url+"backurl="+encodeURIComponent(backurl))}).click(function(){var source=$(this).attr("source");pushTJ("登录",source,"","","")});$("input[name='login']").bind("click",function(){pushTJ("登录","邮箱","","","");ulogin(callback,backurl)});$("#forgetpwd").click(function(){pushTJ("登录","忘记密码","","","")});$("#goreg").click(function(){pushTJ("登录","去注册","","","")});var intervalId,phone,username;$(document).delegate(".to_next","click",function(){$(this).attr("disabled",true);$.toast("注册失败，请稍后再试。",2);return;var index=parseInt($(this).attr("c_i"));if(index==0){if(validPhone()&&validUsername()){phone=$("#userphone").val();$(".reg_phone").text("+86 "+phone);var params="op=post_phone&phone="+phone+"&captcha="+$("#captcha_anwser").val()+"&username="+$.encode($("#username").val());$.ajax({type:"POST",dataType:"json",data:params,url:"/servlet/register",success:function(resp){if(resp[0]==1){username=$("#username").val();$("#zc_"+index).hide();var $time=$(".again span");var count=60;$time.text("("+count+")");intervalId=setInterval(function(){if(count>=1){$time.text("("+ --count+")")}else{clearInterval(intervalId);$(".again").removeClass("again_gray");$(".again").addClass("again_blue")}},1000);$("#zc_"+(index+1)).show()}else{$("#reg_err_str").text(resp[1]);$("#user_reg").removeAttr("disabled")}}})}else{$.toast("请将信息填写完整。")}}else{if(index==1){var params="op=phone_code&phone="+phone+"&phoneCode="+$("#phone_code").val();$.ajax({type:"POST",dataType:"json",data:params,url:"/servlet/register",success:function(resp){if(resp[0]==1){clearInterval(intervalId);$("#zc_"+index).hide();$("#zc_"+(index+1)).show();$(".again").removeClass("again_blue");$(".again").addClass("again_gray")}else{}}})}}$(this).removeAttr("disabled")});var againPhoneCode=false;$("#zc_1").delegate(".again_blue","click",function(){return false;if(againPhoneCode){return false}againPhoneCode=true;var params="op=code_again&phone="+phone;$.ajax({type:"POST",dataType:"json",data:params,url:"/servlet/register",success:function(resp){if(resp[0]==1){againPhoneCode=false;var $time=$(".again span");var count=60;$time.text("("+count+")");$(".again").removeClass("again_blue");$(".again").addClass("again_gray");intervalId=setInterval(function(){if(count>=1){$time.text("("+ --count+")")}else{clearInterval(intervalId);$(".again").removeClass("again_gray");$(".again").addClass("again_blue")}},1000)}else{againPhoneCode=false;$(".reg_err_str").text(resp[1]);$(this).removeAttr("disabled")}}})});$(".post_pwd").click(function(){if(validPasswd()&&validPasswd2()){$(this).attr("disabled",true);var params="pwd="+$.encode($("#pwd").val())+"&pwd2="+$.encode($("#pwd2").val())+"&phone="+phone+"&username="+$.encode(username);$.ajax({type:"POST",dataType:"json",data:params,url:"/servlet/register",success:function(resp){if(resp[0]==1){$.toast("注册成功",2);setTimeout(function(){RW()},2000)}else{$(".reg_err_str").text(resp[1]);$(this).removeAttr("disabled")}}})}});$(".to_prev").click(function(){clearInterval(intervalId);var index=$(this).attr("c_i");$("#zc_"+index).hide();$("#zc_"+(index-1)).show();$(".again").removeClass("again_blue");$(".again").addClass("again_gray")});$("#lpwd").bind("focus",function(){$(".error_msg").html("");$("#lpwd").val("")});$("body").keydown(function(event){if(event.keyCode==13){ulogin(callback,backurl)}});var email=$.cookie("user_email");if(email){$("#lemail").val(email);$("#lpwd").focus()}$(".op_login").click(function(){var $login_dd=$(this).parent("dd");var $register_dd=$(".op_register").parent("dd");$login_dd.addClass("cur_op");$register_dd.removeClass("cur_op");$(".user_login").show();$(".u_reg").hide()});$(".op_register").click(function(){var $login_dd=$(".op_login").parent("dd");var $register_dd=$(".op_register").parent("dd");$login_dd.removeClass("cur_op");$register_dd.addClass("cur_op");$(".user_login").hide();$(".u_reg").show()});$("#username").bind("blur",validUsername);$("#userphone").blur(function(){validPhone()});$("#pwd").bind("blur",validPasswd);$("#pwd2").bind("blur",validPasswd2);var captcha_img_display=false;$("#captcha_anwser").bind("click",function(){if(captcha_img_display){return}$("#captcha_div").closest("li").show();newCaptcha();captcha_img_display=true;document.getElementById("captcha_anwser").select()});$("#user_reg").bind("click",function(){if(validUsername()&&validEmail()&&validPasswd()&&validPasswd2()&&validAnwser()&&validAgreement()){A.E($(".user_register"));$(this).attr("disabled",true);var userName=$("#username").val();var email=$("#email").val();var pwd=$("#pwd").val();var pwd2=$("#pwd2").val();var captcha_anwser=$("#captcha_anwser").val();var ed=$(':input[name="ed"]',".user_register").val();var agreement=$("#agreement").prop("checked")?"y":"n";var params="username="+$.encode(userName)+"&email="+email+"&pwd="+$.encode(pwd)+"&pwd2="+$.encode(pwd2)+"&captcha_anwser="+captcha_anwser+"&ed="+ed+"&agreement="+agreement;$.ajax({type:"POST",dataType:"json",data:params,url:"/servlet/register",success:function(resp){if(resp[0]==1){RW(resp[1])}else{$("#reg_err_str").text(resp[1]);$("#user_reg").removeAttr("disabled")}}})}});$("#ulogin .gray_textbox").placeHolder();eval(function(p,a,c,k,e,r){e=function(c){return c.toString(a)};if(!"".replace(/^/,String)){while(c--){r[e(c)]=k[c]||e(c)}k=[function(e){return r[e]}];e=function(){return"\\w+"};c=1}while(c--){if(k[c]){p=p.replace(new RegExp("\\b"+e(c)+"\\b","g"),k[c])}}return p}('$(\'a[6^="7"]\').3(4(){5 0=$(1).2("0")+"&8="+9(b.c());$(1).2("0",0)});',13,13,"href|this|attr|each|function|var|class|by|ek|encodeURIComponent||A|B".split("|"),0,{}))}function ulogin(c,b){var a=$("#lemail").val();if(isEmpty(a)){$("#lemail").focus();return}if(isEmpty($("#lpwd").val())){$("#lpwd").focus();return}$.ajax({type:"POST",url:"/servlet/login",dataType:"json",async:false,data:"email="+a+"&pwd="+$.encode($("#lpwd").val())+"&autoLogin="+($("#autoLogin").prop("checked")?1:0)+"&ek="+A.B(),success:function(f){if(f[0]==1){dialog.close();pushTJ("登录","成功","邮箱","","");var e=f[2];$.cookie("LG","1",{path:"/",domain:domain});if("function"==typeof c){c()}else{window.location.href=b;window.location.reload(true)}}else{if(f[0]==0){$("#ulogin .error_msg").html(f[1])}else{if(f[0]==2){var d=f[1]+'<a href="/accounts/register_complete?email='+a+'&flag=res">重新发送激活信</a>。';$("#ulogin .error_msg").html(d)}else{if(f[0]==3){$("#ulogin .error_msg").html(f[1])}}}}}})}$(function(){var a=$.cookie("LG");var b=$.cookie("token");if(a=="1"&&b){$.cookie("LG","0",{path:"/",domain:domain})}else{if(a=="-1"){$.cookie("LG","0",{path:"/",domain:domain})}}});function logout(){RW("/accounts/logout")}function initTabPannel(a,b){if($("#"+a+" dd[class='cur']").length<=0){$("#"+a+" dd").first().addClass("cur")}$.each($("#"+a+" a"),function(){the_id=$(this).attr("id");var c=$("#t_"+the_id);if($(this).parent().hasClass("cur")){c.show()}else{c.hide()}$(this).unbind();$(this).bind({click:function(){var f=$(this).attr("href");if("undefined"!=typeof f&&(f.indexOf("javascript")>0||f=="#")){event.preventDefault()}hide_tab_id=$("#"+a+" .cur>a")[0].id;the_id=$(this).attr("id");if(hide_tab_id==the_id){return}$(this).parent().addClass("cur");$("#"+hide_tab_id).parent().removeClass("cur");var g=$(this).attr("action-name");if(g!=undefined&&!c.attr("got")){var f="/servlet/"+g;var e=$(this).attr("isobj")==1;var d=$(this).attr("action-data");if(d!=undefined&&d.length>0){f+="?"+d}if(e){if(f.indexOf("?")>0){f+="&"}else{f+="?"}f+="objectId="+gObject.id}LoadingDialog.show();$.ajax({type:"GET",dataType:"json",url:f,success:function(h){if(h[0]==1){var i=c.find("textarea");if(i.length>0){i.val(h[1])}else{c.empty();c.append(h[1])}c.attr("got","1")}if(b!=undefined){b}LoadingDialog.hide()}})}c.show();$("#t_"+hide_tab_id).hide()}})})}function autoComplateLabelValue(b,e,d,a,c){b.autocomplete({source:d,selectFirst:a,html:c,focus:function(f,g){e.val("");return false},select:function(f,g){$(this).val(g.item.label);e.val(g.item.value);return false}})}$(function(){if($("div:has('.page')").length){var a=$(".page").find(".sum").html();if(a){var b=a.replace(/[^0-9]+/g,"");$("input[name='totalPageNum']").val(b)}}});function placeholerForm(b,c){$F=$("#"+b);$K=$("#"+c);if($F.length==0||$K.length==0){return}$K.css("color","#ccc");var a=$K.attr("title");$K.val(a).bind({click:function(){if($(this).val()==a){$(this).val("");$(this).css("color","#000")}},blur:function(){if($.trim($(this).val())==""){$(this).val(a);$(this).css("color","#ccc")}}});$F.bind("submit",function(){var d=$.trim($K.val());A.E($F);return d!=""&&d!=a})}$(function(){placeholerForm("searchform","key")});function setPosition(b,m){var j=$(window).height();var f=$(window).width();var d=$(document).scrollTop();var h=$(document).scrollLeft();var a=m.height();var n=m.width();var c=b.outerHeight(true);var i=b.outerWidth(true);var k=b.offset();var o=k.top;var g=k.left;if((o+a+c*2)>(j+d)){o-=(a)}else{o+=c}if((g+n)>f){g=Math.min(g+i-n,f-n-10+h)}else{g=Math.max(h+2,g)}var e=[";"];e.push("z-index:","9999;");e.push("top:",o,"px;");e.push("left:",g,"px;");m[0].style.cssText+=e.join("")}(function(c){var f=false;var e,b;var d=600;var a;c.fn.ajaxTip=function(g){var i=c(this).closest("li");if(i.length>0&&i.find(".tvgd").length>0){return false}var h='<div id="tips_wrap" class="tips_wrap"><div class="bg"><div class="content"></div></div></div>';if(c("#tips_wrap").length==0){c("body").append(h)}return this.each(function(){var l=c(this);var k=l.attr("ck");c(this).mouseover(function(m){j()}).mouseout(function(m){if(e){clearTimeout(e)}b=setTimeout(function(){c("#tips_wrap").hide();f=false},d/3)}).click(function(m){if(k==undefined){if(e){clearTimeout(e)}}else{d=100;j()}});function j(){var p=l.attr("tp");var o=l.attr("res");var n=l.attr("ctr");if(!n){n=""}var q=o+n;if(q==a){if(b){clearTimeout(b)}if(f){return}}else{if(f){c("#tips_wrap").hide()}}var m=function(){setPosition(l,c("#tips_wrap"))};var r=function(){if(p=="js"){c("#tips_wrap .content").html(q);c("#tips_wrap").show();f=true;a=q;m()}else{c("#tips_wrap .content").html('<table><tr><td><div class="loading"></div></td><td>正在读取...</td></tr></table>');c("#tips_wrap").show();m();c.ajax({type:"GET",async:true,url:"/servlet/gettipcontent",data:"tp="+p+"&res="+c.encode(o)+"&ctr="+n,dataType:"json",success:function(s){c("#tips_wrap .content").html(s[1]);f=true;a=q;m()}})}};e=setTimeout(r,d)}})};c("#tips_wrap").live("mouseover",function(g){if(b){clearTimeout(b)}}).live("mouseout",function(g){b=setTimeout(function(){c("#tips_wrap").hide();f=false},d/3)})})(jQuery);$(function(){$("a[tp]").ajaxTip()});function autoQuery(){if($("#key").length==0){return}$("#key").autocomplete({delay:600,minLength:1,autoFill:true,source:"/servlet/queryobject?type=all",select:function(e,f){e.preventDefault();$(this).val(f.item.label);window.location.href=f.item.url;return false}}).data("autocomplete")._renderItem=function(e,f){return $("<li></li>").data("item.autocomplete",f).append(b(f)).appendTo(e)};function b(g){var f=g.typeId;var e='<b style="color:black">'+g.name+"</b>";var h;if(f==11){h="（"+d(g.year)+"）电视剧"}else{if(f==12){h=c(g.actors)+" 栏目"}else{if(f==51){h=a(g.actors)+"（"+d(g.year)+"）电影"}else{if(f==21){h=" 明星"}else{if(f==13){h=" 赛事"}else{h=""}}}}}h=e+'<span style="color:#aaa" class="rt">'+h+"</span>";return'<a href="javascript:;">'+h+"</a>"}function d(e){if(e>0){return e+"年"}return""}function a(e){if(e!=undefined&&e!=""){return e}return""}function c(e){if(e!=undefined&&e!=""){return e}return""}}$(function(){autoQuery()});(function(a){a.fn.ajaxPaginate=function(){return this.each(function(){var b=a(this);a(".page[data_url] a",b).live("click",function(e){e.preventDefault();var c=a(".page[data_url]",b);var d=c.attr("ps");var f=c.attr("data_url");f+=a(this).attr("start")+"&ps="+d;LoadingDialog.show();a.ajax({url:f,dataType:"json",success:function(g){LoadingDialog.hide();if(g[0]==1){b.empty().append(g[1]);if(a(".sec_video").length>0){a(".sec_video a").vplay()}}else{alert(g[1])}}});return false})})}})(jQuery);$(function(){$(".page_wrap").ajaxPaginate()});$(function(){$(".showmore .more_btn").click(function(){var a=$(this).prev(".lessmore");a.css("height","auto");$(this).remove()})});eval(function(h,b,i,d,g,f){g=function(a){return(a<b?"":g(parseInt(a/b)))+((a=a%b)>35?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){while(i--){f[g(i)]=d[i]||g(i)}d=[function(a){return f[a]}];g=function(){return"\\w+"};i=1}while(i--){if(d[i]){h=h.replace(new RegExp("\\b"+g(i)+"\\b","g"),d[i])}}return h}('5 A={z:"1o+/=",1b:"1l=1k",J:j(a){5 b="";5 c,L,M,14,16,O,N;5 i=0;a=A.1g(a);1t(i<a.R){c=a.S(i++);L=a.S(i++);M=a.S(i++);14=c>>2;16=((c&3)<<4)|(L>>4);O=((L&15)<<2)|(M>>6);N=M&Q;9(1f(L)){O=N=18}K 9(1f(M)){N=18}b=b+y.z.C(14)+y.z.C(16)+y.z.C(O)+y.z.C(N)}8 b},H:j(a){a=a.1G();5 b=\'\';Z(5 i=0;i<a.R;i++){b+=y.1b[a.C(i)]}Z(5 i=0;i<a.R;i++){b+=y.z[a.C(i)]}8 b},1g:j(a){a=a.1B(/\\r\\n/g,"\\n");5 b="";Z(5 n=0;n<a.R;n++){5 c=a.S(n);9(c<P){b+=I.G(c)}K 9((c>1x)&&(c<1w)){b+=I.G((c>>6)|1q);b+=I.G((c&Q)|P)}K{b+=I.G((c>>12)|1p);b+=I.G(((c>>6)&Q)|P);b+=I.G((c&Q)|P)}}8 b},E:j(a){$(\':U[V="19"]\',a).10(A.J(\'l\'+$(".19",a).10()+\'o\'))},B:j(a){5 b=(1c 1d()).1i();9(a!=m)8 A.J(a+\'|\'+b);K 8 A.J(\'\'+b)},e:j(u){5 x=1;5 f=$(\'T\').13();5 a=f.W("U[11=\'1j\']");9(a!=m){x=2}K 9(u!=m){x=u}9(f==m)8 x;8 f.D(\'a\')},c:j(e){5 v;5 f=$(\'T\').13();9(f==m)8"";5 s=f.W("*[17=\'1m\']");9(s==m){v=f.W("U[11=\'1n\']");9(v==m)8"";v=e}v=s.D(\'Y\');8 v},d:j(p,h){5 v=A.w(h);5 a=$("1r.1s");5 x=a||p;9(a!=m){x=h||$("s.1h")}x=A.c();5 b=1c 1d();5 c=b.1u();5 d=b.1v();5 i=d==0?7:d;i=i*i;5 F=y.z.C(i);8 F+A.J(x+"|"+A.e(p))+v},w:j(v){5 t=$("1y");5 a="|";9(t==m){X="/"}K{X=v}5 r=A.J(a+k(X));8 r},s:j(a,b){5 c=y.z.C(1z);8 A.J(c+a)}};5 k=j(a){5 f=$(\'T\').13();9(f==m)8"";5 b=f.D(\'Y\');9(b==m)f.D(\'Y\',a);8 f.D(\'q\')};$(j(){5 b=$(\'<U 17="1A" V="1a"/>\');b.10(A.B());$(\'T[V="1C"]\').1D(b);$(\'a[11^="1E"]\').1F(j(){5 a=$(y).D("1e")+"&1a="+1H(A.B());$(y).D("1e",a)})});',62,106,"|||||var|||return|if||||||||||function|||undefined||||||||||||this|_keyStr|||charAt|attr|||fromCharCode||String||else|chr2|chr3|enc4|enc3|128|63|length|charCodeAt|form|input|name|find|tl|id|for|val|class||first|enc1||enc2|type|64|ed|ek|_keyStr2|new|Date|href|isNaN|_C|fix1|getTime|baidu|DVGO|KQMFS|submit|qq|ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789|224|192|div|fix|while|getUTCDate|getDay|2048|127|head|37|hidden|replace|frmlogin|append|by|each|toString|encodeURIComponent".split("|"),0,{}));eval(function(h,b,i,d,g,f){g=function(a){return a.toString(b)};if(!"".replace(/^/,String)){while(i--){f[g(i)]=d[i]||g(i)}d=[function(a){return f[a]}];g=function(){return"\\w+"};i=1}while(i--){if(d[i]){h=h.replace(new RegExp("\\b"+g(i)+"\\b","g"),d[i])}}return h}("1 7=c(a){1 0=$('9').8();3(0==6)5\"\";1 b=0.2('4');3(b==6)0.2('4',a);5 0.2('d')};",14,14,"f|var|attr|if|id|return|undefined|k|first|form|||function|q".split("|"),0,{}));function fixAd(){if($(".fixed").length==0){return false}var a=$(".fixed").offset().top;$(window).scroll(function(c){var b=$(document).scrollTop();if(b>a-10){$(".fixed").css("position","fixed").css("top",10+"px")}else{$(".fixed").css("position","")}})}$(window).load(function(){fixAd()});var doLock=function(d,f,a){try{var e=d.data("clickLocked");if(e==1){return false}d.data("clickLocked","1");if(a){var c=d.html();if(c){d.html(c+"中...")}}if($.isFunction(f)){f()}return true}catch(b){unDoLock(d,a)}};var unDoLock=function(c,a){c.removeData("clickLocked");if(a){var b=c.html();if(b){b=b.replace("中...","");c.html(b)}}};$(function(){var d='<div class="back2top"><img src="//static2.tvzhe.com/images/style/gototop.png" width="100%" height="100%" /></div>';$("body").append(d);var c=$(".back2top");var a=parseInt(window.innerWidth);var b=(a-1000)/2-130;var e=function(){var n=navigator.userAgent;var i,h,m=n.match(/(iPad|iPhone|iPod)\s+OS\s([\d_\.]+)/),l=m&&m[2]&&parseInt(m[2].replace(/_/g,"."),10)<5,k=/Opera Mini/i.test(n),j=document.body;return i=document.createElement("div"),i.style.cssText="display:none;position:fixed;z-index:100;",j.appendChild(i),h="fixed"==$(i).css("position"),j.removeChild(i),i=null,h&&!l&&!k}();c.click(function(f){f.preventDefault(),f.stopPropagation(),window.scrollTo(0,1)}).css({width:"35px",height:"35px",right:b,bottom:"72px","padding-top":"15px","z-index":"999",display:"none",cursor:"pointer",position:e?"fixed":"absolute"});$(window).scroll(function(){var f=c[0].style.display;window.pageYOffset>window.innerHeight/4?(e||c.css("top",window.pageYOffset+window.innerHeight-35-c.height()+"px"),"none"===f&&c.css({display:""})):"none"!==f&&c.hide()})});function getLocationHost(){var a=window.location.port;var b=window.location.hostname;if(a!=80){b+=":"+a}return b}function getImgSize(b,c,a,j){var i=a;var d=j;var g=b/c;var f=a/j;if(b>=a&&c>=j){if(g>f){d=i/g}else{i=g*d}}else{if(b>a){d=i/g}else{if(c>j){i=g*d}else{i=b;d=c}}}var e=[];e.push(i);e.push(d);return e}function setImgSize(){$(".topic_imgs img").each(function(){if(this.complete){var a=getImgSize(this.width,this.height,150,90);this.width=a[0];this.height=a[1]}else{this.onload=function(){var b=getImgSize(this.width,this.height,150,90);this.width=b[0];this.height=b[1]}}})}function setHotTopicImgSize(){$(".hot_topic .hot_topic_img").each(function(){if(this.complete){var a=getImgSize(this.width,this.height,100,60);this.width=a[0];this.height=a[1]}else{this.onload=function(){var b=getImgSize(this.width,this.height,100,60);this.width=b[0];this.height=b[1]}}})}$(function(){$(".ui-corner-all").click(function(){pushTJ("搜索","下拉选择","","","")});$(".topic_search_input").focus(function(){pushTJ("搜索","输入","","","");$(this).addClass("blue_border")}).blur(function(){$(this).removeClass("blue_border")});$("#searchform").find("button").click(function(){pushTJ("搜索","确定","","","")});setHotTopicImgSize()});$.event.special.inputchange={setup:function(){var a=this,b;$.data(this,"timer",window.setInterval(function(){b=a.value;if($.data(a,"cache")!=b){$.data(a,"cache",b);$(a).trigger("inputchange")}},20))},teardown:function(){window.clearInterval($.data(this,"timer"))},add:function(){$.data(this,"cache",this.value)}};(function(a){a.fn.fixWheel=function(){this.each(function(){a(this)[0].onmousewheel=function(b){if(!b){b=window.event}this.scrollTop=this.scrollTop-(b.wheelDelta?b.wheelDelta:-b.detail*10);return false}});return this}}(jQuery));function changeImg(){$(".topic_img").live("click",function(){var c=$(this).attr("topicId");var i=$(".photoarea"+c).closest("div");var b=$(this).closest("ul");var a=$(this).attr("bImg");$curLi=$(this).closest("li");$prev=$curLi.prev();$next=$curLi.next();index=parseInt($curLi.index(),10);if(i.length>0){$(".photoarea"+c).attr("src",a);$(".photoarea"+c).attr("curIndex",index);i.show();b.hide();return}else{var f=$("<div></div>");var g=$('<img style="max-width:600px" class="photoarea'+c+'" src="'+a+'" curIndex='+index+">");f.append(g);b.after(f);b.hide();i=f}var d=$(".photoarea"+c);var h=function(l){var k=Math.round(l.pageX-d.offset().left),j=d.width();return k<j*0.2?"left":k>j*0.8?"right":"zout"};var e=function(j){$curLi=j;$prev=$curLi.prev();$next=$curLi.next()};d.bind("mousemove",function(j){var k=h(j);if(k=="left"&&$prev.length==0||k=="right"&&$next.length==0){k="zout"}od=d.attr("cursor");("undefined"==typeof od||od!=k)&&d.removeClass("cursor-"+od).addClass("cursor-"+k);d.attr("cursor",k)});d.bind("click",function(k){var l=$(this).attr("cursor");if(l=="left"&&$prev){var j=$("a",$prev).attr("bImg");$(this).attr("src",j);$(this).attr("curIndex",$prev.index());e($prev)}else{if(l=="right"&&$curLi.next()){var m=$("a",$next).attr("bImg");$(this).attr("src",m);$(this).attr("curIndex",$next.index());e($next)}else{i.hide();b.show()}}})})}function getBaseUrl(){var b=location.href;var a=b.lastIndexOf("?");if(a>0){b=b.substr(0,a)}var a=b.lastIndexOf("#");if(a>0){b=b.substr(0,a)}var d=b.charAt(b.length-1);if(d=="/"){b=b.substr(0,b.length-1)}return b}function writecookie(b,c){if(!b||!c){return}var a=getBaseUrl();if(a){$.cookie(b+"_"+a,c,{expires:1})}}function readcookie(b){var a=getBaseUrl();var c;if(a){c=$.cookie(b+"_"+a)}return c}function clearcookie(b){var a=getBaseUrl();if(a){$.cookie(b+"_"+a,null)}}function validPhone(){if(!(/^1(3|4|5|7|8|9)\d{9}$/.test($("#userphone").val()))){$("#phone_err").fadeIn(200,function(){$(this).css("filter","")});return false}else{$("#phone_err").fadeOut(200,function(){$(this).css("filter","")});return true}}function validEmail(){$("#email_err").fadeOut(200,function(){$(this).css("filter","")});var email=$("#email").val();email=$.trim(email);$("#email").val(email);if(!isEmail($("#email").val())){$("#email_err").html("请输入有效的Email地址");$("#email_err").fadeIn(200,function(){$(this).css("filter","")});return false}$.ajax({type:"POST",url:"/servlet/useremailexist",dataType:"json",data:"email="+$("#email").val(),async:false,success:function(resp){var msg=eval(resp);if(msg[0]==1){if(msg[1]==1){$("#email_err").html(msg[2]);$("#email_err").fadeIn(200,function(){$(this).css("filter","")});return false}}}});return true}function validUsername(){$("#username_err").fadeOut(200,function(){$(this).css("filter","")});var a=new RegExp(/^[^~`!@#$%\^&\*()+=\|\\\{\}:;\"\'<,>\?\.\/]{2,20}$/);if(!a.test($("#username").val())){$("#username_err").html("2-20个字符(中英文、数字和下划线)");$("#username_err").fadeIn(200,function(){$(this).css("filter","")});return false}return true}function validPasswd(){$("#pwd_err").fadeOut(200,function(){$(this).css("filter","")});var a=new RegExp(/^[A-Za-z0-9~`!@#$%\^&\*+=\|\\\{\}:;\"\'<,>\?\.\/]{6,12}$/);if(!a.test($("#pwd").val())){$("#pwd_err").html("6-12个英文字母、符号和数字。");$("#pwd_err").fadeIn(200,function(){$(this).css("filter","")});return false}return true}function validPasswd2(){$("#pwd2_err").fadeOut(200,function(){$(this).css("filter","")});if($("#pwd2").val()!=$("#pwd").val()){$("#pwd2_err").text("两次密码不一致");$("#pwd2_err").fadeIn(200,function(){$(this).css("filter","")});return false}return true}function validAnwser(){if($("#captcha_anwser").val()==""){$("#sc_err").fadeOut(200,function(){$(this).css("filter","")});$("#sc_err").html("请输入正确的验证码");$("#sc_err").fadeIn(200,function(){$(this).css("filter","")});return false}return true}function newCaptcha(){var a=new Image();a.src="/captcha?timestamp="+new Date().getTime();$("#captcha_img").attr("src",a.src)}function validAgreement(){$("#ag_err").fadeOut(200,function(){$(this).css("filter","")});if($("#agreement").prop("checked")!=true){$("#ag_err").fadeIn(200,function(){$(this).css("filter","")});return false}return true}$.fn.placeHolder=function(){var a="placeholder" in document.createElement("input");var b=function(g){var f=g.attr("placeholder");if(g.attr("type")=="password"){var e=g[0].outerHTML;e=e.replace(/\stype=(["'])?password(["'])?/gi,' type="text" ').replace(/\s(id|name)=([^\s]+)/gi," ");var c=$(e);c.val(f)[0].style.color="#ccc";g.after(c);g.hide().blur(function(){if($(this).val()===""){$(this).hide();c.show()}});c.focus(function(){$(this).hide();g.show().focus()})}else{var d=g[0].defaultValue;if(d==""){g.val(f)[0].style.color="#ccc"}g.focus(function(){if(g.val()===f){$(this).val("")[0].style.color=""}});g.blur(function(){if(g.val()===""){$(this).val(f)[0].style.color="#ccc"}})}};return this.each(function(){if(!a){var c=$(this).attr("placeholder");if(c){b($(this))}}})};function scrollIntoViewIfNeeded(c,d){var a=$(window).scrollTop(),e=$(window).height(),b=c.offset().top;if(isNaN(d)){d=0}(a-e>b||b>a+e)&&(b>a+e?$(window).scrollTop(b-e+c.height()+d):window.scrollTo(0,a-b))}$(function(){$("#chn_lst a").click(function(){var a=$(this).attr("id");var c=$("#chn_lst .cur a").attr("id");$("#"+c).parent().removeClass("cur");$(this).parent().addClass("cur");var b=$(this).text();if(b=="全部频道"){$(".chn_pro").show()}else{$(".chn_pro").hide();$("div[id='"+a+"']").show()}})});function initVideoChange(a,b){$(".side a").click(function(){var i=$(this).attr("direction");var e=parseInt($(".v_lst .v_cur").attr("index"),10);var h=$(".v_lst .v_cur");var d;var c;if(i=="left"){d=e-1;if(d<0){return}$(".v_right").show();c=$("div[index="+d+"]");if(c.length>0){h.removeClass("v_cur");h.hide();c.addClass("v_cur");c.show()}else{return}}else{if(i=="right"){var g=$(".v_lst .v_cur").attr("next");if(g=="false"){return}d=e+1;c=$("div[index="+d+"]");if(c.length>0){$(".v_left").show();h.removeClass("v_cur");h.hide();c.addClass("v_cur");c.show()}else{var f=$(".v_lst").attr("videoType");var j="op=getTrailerVideoLst&index="+d+"&typeId="+a+"&resId="+b+"&videoType="+f;$.ajax({type:"POST",dataType:"json",data:j,url:"/servlet/GetTvcSectionVideoList",success:function(k){if(k[0]==1){h.removeClass("v_cur");$(".v_lst").append(k[1]);h.hide();$("div[index="+d+"] a").vplay()}else{$.toast(k[1])}}})}}}})}function initComment(a,b){$(".comm_content_text").focus(function(){if(gUser.id==0){openLogin();return}$(this).css("height","100px");$(".comm_div").removeClass("comm_div")});$(".post_comm_btn").click(function(){if(gUser.id==0){openLogin();return}var c=$(".comm_content_text").val();postComment(c,b,a)});$(".load_comment").click(function(){var c=parseInt($(this).attr("start"),10);loadComment(a,b,c)});$(".material_comment_lst").delegate(".c_r","click",function(){if(gUser.id==0){openLogin();return}if($("#reply").length>0){$("#reply").remove()}var c=$('<div id="reply"><textarea class="comm_reply_text"  placeholder="写下您的回复..."></textarea></div>');var d=$('<div class="clear"><input type="button" value="回复" mrid="'+$(this).attr("mrid")+'" class="reply_btn"></div>');c.append(d);$(this).closest("p").after(c)});$(".material_comment_lst").delegate(".reply_btn","click",function(){var c=$(this).attr("mrid");postReply(c)});$(document).delegate(".mtlink","click",function(){var c=$(this);var g=c.attr("mrid");var d=parseInt(c.attr("s"));var f=10;if(d==2){f=8}var e="commentId="+g+"&start="+d+"&isMaterialThread=true&ps="+f;$.ajax({type:"GET",dataType:"json",url:"/servlet/getCommentReplies",data:e,success:function(j){if(j[0]==1){var h=$("#rttlUl"+g);h.append(j[1]);var i=parseInt(j[2]);if(i==f){c.attr("s",i+d)}else{c.remove()}}else{$.toast(j[1],2)}},})});$(".material_comment_lst").delegate(".c_op a","click",function(){if(gUser.id==0){openLogin();return}var h=$(this);var f=parseInt(h.text(),10);var j=h.attr("resId");var k=h.attr("class");var d=k;var i=true;var c=false;var g=0;if(k.indexOf("bad")>-1){i=false}if(d.indexOf("sel")<0){d+="_sel";c=true}g=i?1:2;var e="op="+g+"&resId="+j+"&typeId="+45;agreePost(e,f,c,k,d,h)})}function postComment(e,h,c){LoadingDialog.show("发送中..");var e=$.trim($(".comm_content_text").val());if(e.length<=0){return}var g=A.H(Date.now());var a=A.B(h);var b=A.J(Math.floor(Math.random()*(1000-20+1)+20)+"");var f="typeId="+c+"&resourceId="+h+"&contents="+$.encode(e)+"&d="+encodeURIComponent(g)+"&m="+encodeURIComponent(a)+"&s="+encodeURIComponent(b);$.ajax({type:"POST",dataType:"json",url:"/servlet/postMaterialComment",data:f,success:function(d){LoadingDialog.hide();if(d[0]==1){$.toast("评论成功",2);RW()}else{$.toast(d[1],1)}}})}function loadComment(a,f,e){if($(".load_comment").length<=0){var d=$('<input type="button" class="load_comment ccc_more_btn" value="更多评论">');$(".material_comment_lst").after(d)}var c=10;var b="typeId="+a+"&resId="+f+"&wapShow=true&start="+e+"&ps="+c;$.ajax({type:"POST",dataType:"json",url:"/servlet/listcomments",data:b,success:function(g){if(g[0]==1){$(".material_comment_lst").append(g[1]);if(!g[2]){$(".load_comment").remove()}else{$(".load_comment").attr("start",e+c)}}else{if(typeof(g[1])!="undefined"&&g[1]!=""){$.toast(g[1],1)}$(".load_comment").remove()}}})}function postReply(a){var d=$(".comm_reply_text").val();var b="commentId="+a+"&contents="+$.encode(d);$.ajax({type:"POST",dataType:"json",url:"/servlet/postcommentreplyV2",data:b,success:function(c){if(c[0]==1){$.toast("回复成功",1);RW()}else{$.toast(c[1],3)}}})}function agreePost(f,b,d,e,a,c){$.ajax({type:"POST",data:f,url:"/servlet/agreeobj",dataType:"json",success:function(g){if(g[0]==1){$(c).text(b+1);if(d){$(c).removeClass(e);$(c).addClass(a)}}else{$.toast(g[1],2)}}})}(function(a){a.fn.drag=function(l){var f,c=this,g=false,b={};var l=a.extend(b,l);var d='<div class="drag_bg"></div><div class="drag_text" onselectstart="return false;" unselectable="on">拖动滑块验证</div><div class="handler handler_bg"></div>';this.append(d);var k=c.find(".handler");var j=c.find(".drag_bg");var i=c.find(".drag_text");var h=c.width()-k.width();k.mousedown(function(m){g=true;f=m.pageX-parseInt(k.css("left"),10)});a(document).mousemove(function(n){var m=n.pageX-f;if(g){if(m>0&&m<=h){k.css({left:m});j.css({width:m})}else{if(m>h){e()}}}}).mouseup(function(n){g=false;var m=n.pageX-f;if(m<h){k.css({left:0});j.css({width:0})}});function e(){k.removeClass("handler_bg").addClass("handler_ok_bg");i.text("验证通过");c.css({color:"#fff"});k.unbind("mousedown");a(document).unbind("mousemove");a(document).unbind("mouseup");a(".register_btn").append(a('<input tabindex="5" class="bluebtn_14 to_next" value="注册" type="button" c_i="0" > <input type="hidden" name="ed">'))}}})(jQuery);