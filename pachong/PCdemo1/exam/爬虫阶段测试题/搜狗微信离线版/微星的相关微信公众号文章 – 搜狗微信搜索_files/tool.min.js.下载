(function(){function d(b){return"weixin?type=2&ie=utf8&query="+encodeURIComponent(window.oldQuery)+objToUrlParam(b)}var a=window.toolParas,e=$(".input-box-err"),k=$("#text"),h=$("#tool"),l=h.find("#time"),n=l.next(),m=h.find("#type"),p=m.next(),q=h.find("#search"),r=q.next(),t=$("#tool_hide"),u=$("#tool_clear"),f=new DatePicker("#date_start",{position:"right",deltaX:16,deltaY:0,current:a.ft?new Date(a.ft):new Date}),g=new DatePicker("#date_end",{position:"right",deltaX:16,deltaY:0,current:a.et?new Date(a.et):new Date});(function(){$("body").on("blur",".zdy input",function(){var b=$(this),a="date_start"==b.attr("id")?f:g;a.validate(a.getValue())?(b.removeClass("cur"),e.hide()):(b.addClass("cur"),e.show())});$("body").on("click","#time_enter",function(){var b=!0;if(!f.validate(f.getValue()))return b=!1,$("#date_start").addClass("cur"),e.show(),b;if(!g.validate(g.getValue())||b&&g.getValue()<f.getValue())return b=!1,$("#date_end").addClass("cur"),e.show(),b;b&&(a.tsn=5,a.ft=f.getValue(),a.et=g.getValue(),location.href=d(a))});$("body").on("click","#type_enter",function(){var b=[];$("input[type='checkbox']:checked").each(function(){b.push($(this).val())});a.interation=b.join(",");location.href=d(a)});$("body").on("click","a.time-range",function(){a.tsn=$(this).attr("data-type")});$("body").on("click","#tool_show",function(){u.hide();t.show();k.parent().addClass("all-time-y2-cur")});$("body").on("click","#tool_hide",function(){$(".btn-time").removeClass("cur");k.parent().removeClass("all-time-y2-cur")});$("body").on("click","#tool_clear",function(){$(".btn-time").removeClass("cur");k.parent().removeClass("all-time-y2-cur");setTimeout(function(){location.href=d({})},600)});$("body").on("click","a.btn-time",function(){$(this).hasClass("cur")||clearFloat();var b,a;b=$(this).attr("id");"time"==b?(b=p,a=r):"type"==b?(b=n,a=r):(b=n,a=p);var d=$(this);b.hide();a.hide();d.next().toggle();d.toggleClass("cur")});$("body").on("click","#search_enter",function(){var b=$(this).prev().val();a.wxid=b;(a.usip=b)?(b=b.trim(),$.ajax({url:"weixin?zhnss=1&type=1&ie=utf8&query="+encodeURIComponent(b),dataType:"json",success:function(c){successBack(c)&&c.openid&&(b===c.weixinname||b===c.weixinhao)?(a.wxid=c.openid,location.href=d(a)):$("p.input-box-err").fadeIn()},error:function(){$("p.input-box-err").fadeIn()}})):location.href=d(a)});$("body").on("keyup","input.s-sea",function(a){if("13"==a.keyCode)return $("#search_enter").click(),!1})})();(function(){h.find(".time-range").each(function(){var b=$(this).attr("data-type"),c={tsn:b,ft:"",et:"",interation:a.interation,wxid:a.wxid,usip:a.usip};a.tsn&&(b!=a.tsn?$(this).attr("href",d(c)):l.html($(this).html()))});if(5==a.tsn&&a.ft&&a.et){var b="",b=a.ft==a.et?a.ft:a.ft+"\u81f3"+a.et;l.html(b)}if(a.interation){var c=[];$("input[type='checkbox']").each(function(){-1!=a.interation.indexOf($(this).val())&&($(this).attr("checked",!0),c.push($(this).next().html()))});0===c.length?m.html("\u5168\u90e8\u7c7b\u578b"):m.html(c.join("\uff0c"))}b="\u8d26\u53f7\u5185\u641c\u7d22";a.usip&&(b=b+"\uff1a"+a.usip,$("input.s-sea").val(a.usip));q.html(b);"1"===window.from_tool&&(u.show(),t.hide())})()})();